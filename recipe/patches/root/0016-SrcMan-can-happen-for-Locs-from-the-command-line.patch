From 697564ac66dd155d52414397168962e1292c1a87 Mon Sep 17 00:00:00 2001
From: Axel Naumann <Axel.Naumann@cern.ch>
Date: Tue, 1 Jul 2014 14:23:49 +0200
Subject: [PATCH 16/83] !SrcMan can happen for Locs from the command line!

Fixes issue reported by Guy Barrand and others; test coming up.
---
 include/clang/Basic/SourceLocation.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/include/clang/Basic/SourceLocation.h b/include/clang/Basic/SourceLocation.h
index 540de23b9f..28810d2176 100644
--- a/include/clang/Basic/SourceLocation.h
+++ b/include/clang/Basic/SourceLocation.h
@@ -431,6 +431,7 @@ public:
   /// \returns true if this source location comes before 'Loc', false otherwise.
   bool isBeforeInTranslationUnitThan(FullSourceLoc Loc) const {
     assert(Loc.isValid());
+    if (!SrcMgr) return true; // assume command line is before Loc
     assert(SrcMgr == Loc.SrcMgr && "Loc comes from another SourceManager!");
     return isBeforeInTranslationUnitThan((SourceLocation)Loc);
   }
-- 
2.34.1

